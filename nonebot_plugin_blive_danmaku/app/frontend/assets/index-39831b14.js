import{a as e,p as a,w as l,x as t,y as s,k as u,A as o,B as d,C as r,D as n,c as i,F as p,f as m,G as c,H as v,v as f,t as g,u as y,I as _}from"./elementPlus-4153dd68.js";import{E as k,r as b,aG as h,b as x,j as V,P as C,S as z,u as U,k as Y,h as w,V as j,a0 as T,T as D,Q as E,ad as M,W as P}from"./vendor-77f251a3.js";import{u as S,g as I,d as X,b as G,e as W,c as q}from"./index-8cc691e9.js";import"./lodash-520df23f.js";const A={class:"danmaku-room-list"},B={class:"image-slot"},F=["onClick"],H={style:{padding:"14px"}},N={class:"danmaku-badge"},O={class:"bottom"},Q={class:"time"},J=Y("br",null,null,-1),K=Y("br",null,null,-1),L={style:{"margin-top":"20px","margin-bottom":"20px"}},R=k({__name:"index",setup(k){const R=b([]),Z=b(0),$=b(1),ee=b([10,20,30,50]),ae=b(20),le=b(!0),te=b(),se=b({}),ue=S(),oe=e=>{ae.value=e,pe()},de=e=>{$.value=e,pe()},re=h(),ne=e=>{re.push({path:"/room",query:{roomid:e,type:ue.getType,type_id:ue.getTypeId,uid:ue.getUid}})},ie=()=>{te.value.setScrollTop(0)},pe=()=>{le.value=!0;const a=ue.getType,l=ue.getTypeId,t=ue.getUid;if(!a||!l)return e({title:"Error",message:"当前地址有误，请从bot重新获取面板地址",type:"error"}),le.value=!1,!1;const s={type:a,type_id:l,uid:t,page:$.value,size:ae.value,title:se.value.title,danmaku:se.value.danmaku,start:se.value.start,end:se.value.end};X(s).then((a=>{if(0!=a.code)return e({title:"Error",message:a.msg||"系统异常",type:"error"}),!1;const l=a.data,t=l.rows;for(let e of t)e.cover.startsWith("/")&&(e.cover=G+e.cover);R.value=[],Object.assign(R.value,t),Z.value=l.total,le.value=!1,ie()})).catch((a=>{le.value=!1,e({title:"Error",message:"请求异常",type:"error"})}))},me=()=>{$.value=1,pe()};return x((()=>{ie();const e=I("type"),a=I("type_id");ue.setState(a,e);const l=I("uid");ue.setUid(l),(()=>{const e={uid:ue.getUid};W(e).then((e=>{document.title=e.data.data}))})(),pe()})),(e,k)=>{const b=o,h=d,x=r,S=n,I=i,X=p,G=a,W=m,ue=l,re=y,ie=_,pe=c,ce=t,ve=v,fe=f;return w(),V("div",A,[C(G,{style:{width:"100%"}},{default:z((()=>[C(X,{ref:"form",model:se.value,inline:"","label-position":"left","label-width":"50px"},{default:z((()=>[C(h,{label:"标题"},{default:z((()=>[C(b,{modelValue:se.value.title,"onUpdate:modelValue":k[0]||(k[0]=e=>se.value.title=e),clearable:"",placeholder:"输入一个直播标题"},null,8,["modelValue"])])),_:1}),C(h,{label:"路灯"},{default:z((()=>[C(b,{modelValue:se.value.danmaku,"onUpdate:modelValue":k[1]||(k[1]=e=>se.value.danmaku=e),clearable:"",placeholder:"这里可以搜索路灯"},null,8,["modelValue"])])),_:1}),C(h,{label:"时间"},{default:z((()=>[C(S,{span:6},{default:z((()=>[C(x,{modelValue:se.value.start,"onUpdate:modelValue":k[2]||(k[2]=e=>se.value.start=e),type:"date",label:"Pick a date","value-format":"X",placeholder:"选择一个开始日期",format:"YYYY-MM-DD"},null,8,["modelValue"])])),_:1}),C(S,{class:"text-center",span:6},{default:z((()=>[j("-")])),_:1}),C(S,{span:6},{default:z((()=>[C(x,{modelValue:se.value.end,"onUpdate:modelValue":k[3]||(k[3]=e=>se.value.end=e),type:"date",label:"Pick a date","value-format":"X",placeholder:"选择一个结束日期",format:"YYYY-MM-DD"},null,8,["modelValue"])])),_:1})])),_:1}),C(h,null,{default:z((()=>[C(I,{type:"primary",onClick:me},{default:z((()=>[j("搜索")])),_:1})])),_:1})])),_:1},8,["model"])])),_:1}),C(ue,null,{default:z((()=>[C(W,null,{default:z((()=>[C(U(s))])),_:1})])),_:1}),C(U(u),{class:"danmaku-scroll-area","max-height":"40rem",ref_key:"scrollbar",ref:te,"view-style":{overflowX:"hidden"}},{default:z((()=>[T((w(),D(ce,{gutter:10,style:{width:"100em"}},{default:z((()=>[R.value.length>0?(w(!0),V(E,{key:0},M(R.value,(e=>(w(),D(S,{key:e.id,span:6,style:{"padding-top":"1%","padding-bottom":"1%"}},{default:z((()=>[C(G,{class:"danmaku-room-card"},{default:z((()=>[C(re,{alt:e.title,src:e.cover,referrerpolicy:"no-referrer",loading:"lazy","scroll-container":".danmaku-scroll-area",style:{cursor:"pointer"},onClick:a=>ne(e.id)},{placeholder:z((()=>[T(Y("div",B,null,512),[[fe,!0]])])),error:z((()=>[Y("div",{class:"image-slot",onClick:a=>ne(e.id)},[C(W,null,{default:z((()=>[C(U(g))])),_:1})],8,F)])),_:2},1032,["alt","src","onClick"]),Y("div",H,[C(ie,{value:e.count,max:99},{default:z((()=>[Y("span",N,P(e.title),1)])),_:2},1032,["value"]),Y("div",O,[Y("time",Q,[j("开始："+P(U(q)(e.start_time))+" ",1),J,j("~"),K,j(" 结束："+P(U(q)(e.end_time)),1)]),C(I,{text:"",class:"button"},{default:z((()=>[j(P(e.name),1)])),_:2},1024)])])])),_:2},1024)])),_:2},1024)))),128)):(w(),D(S,{key:1,span:24},{default:z((()=>[C(pe,{description:"No data"})])),_:1}))])),_:1})),[[fe,le.value]])])),_:1},512),Y("div",L,[C(ce,{gutter:20},{default:z((()=>[C(S,{span:12,offset:0},{default:z((()=>[C(ve,{background:"",layout:"total,sizes,prev,pager,next","page-size":ae.value,"page-sizes":ee.value,total:Z.value,"current-page":$.value,onSizeChange:oe,onCurrentChange:de},null,8,["page-size","page-sizes","total","current-page"])])),_:1})])),_:1})])])}}});export{R as default};
