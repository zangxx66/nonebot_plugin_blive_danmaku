import{a,U as t,D as e,x as o}from"./elementPlus-45096342.js";import{g as s,h as l,R as r,F as d}from"./index-b9c53aae.js";import{i as n,L as u,u as i,a as m,b as c,c as h,d as p,e as v,f,g,h as y,j as _,k}from"./echarts-5716f42a.js";import{E as w,h as x,j as b,r as j,b as M,k as A,P as S,S as E,Q as B,aM as C,aN as D}from"./vendor-fa374c7f.js";import{_ as F}from"./_plugin-vue_export-helper-1b428a4d.js";import"./lodash-520df23f.js";const I={id:"word-cloud",style:{width:"65rem",height:"100px"}},P=w({__name:"wordcloud",setup:(a,{expose:t})=>(t({loadData(a){const t=Array();for(let e of a)t.push({name:e.message,value:e.sum});n(document.getElementById("word-cloud")).setOption({series:[{type:"wordCloud",data:t,emphasis:{textStyle:{shadowBlur:10,shadowColor:"#333"}},textStyle:{fontFamily:"sans-serif,PingFang SC,Microsoft YaHei,微软雅黑",fontWeight:"bold",color:function(){return"rgb("+[Math.round(160*Math.random()),Math.round(160*Math.random()),Math.round(160*Math.random())].join(",")+")"}}}]})}}),(a,t)=>(x(),b("div",I)))}),G={class:"danmaku-hot-word"},L=(a=>(C("data-v-280a5f94"),a=a(),D(),a))((()=>A("div",{id:"danmaku-chart",class:"danmaku-chart"},null,-1))),O=F(w({__name:"index",setup(w){const C=j(),D=j({total:0,avg_danmaku:0,watched:0,hot_word:Array(),minute_danmaku:Array()}),F=()=>{const t=s("roomid");l({rid:t}).then((t=>{if(0!=t.code)a({title:"提示",message:"获取统计信息失败",type:"error"});else{D.value.avg_danmaku=t.data.avg_danmaku,D.value.total=t.data.total;const a=t.data.hot_word;C.value.loadData(a),a.forEach((a=>a.message=r(a.message))),D.value.hot_word=a,D.value.minute_danmaku=t.data.min_danmaku,D.value.watched=t.data.watched,(()=>{const a={xAxis:{type:"category",data:Array.from(D.value.minute_danmaku,(({countTime:a})=>d(a))),boundaryGap:!1,axisTick:{alignWithLabel:!0}},yAxis:{type:"value",boundaryGap:[0,"100%"],name:"弹幕数"},series:[{name:"弹幕数",data:Array.from(D.value.minute_danmaku,(({sum:a})=>a)),type:"line",symbol:"rect",sampling:"lttb",smooth:!0,itemStyle:{color:"rgb(255, 70, 131)"},areaStyle:{color:new u(0,0,0,1,[{offset:0,color:"rgb(255, 158, 68)"},{offset:1,color:"rgb(255, 70, 131)"}])}}],tooltip:{trigger:"axis",position:a=>[a[0],"10%"]},title:{text:"每分钟弹幕统计"},dataZoom:[{type:"inside",start:0,end:100},{start:0,end:100}]};i([m,c,h,p,v,f,g,y,_,k]);const t=document.getElementById("danmaku-chart");n(t).setOption(a)})()}})).catch((t=>{a({title:"提示",message:t||"获取统计信息失败",type:"error"})}))};return M((()=>{F()})),(a,s)=>{const l=t,r=e,d=o;return x(),b(B,null,[A("div",null,[S(d,null,{default:E((()=>[S(r,{span:8},{default:E((()=>[S(l,{title:"弹幕数",value:D.value.total},null,8,["value"])])),_:1}),S(r,{span:8},{default:E((()=>[S(l,{title:"平均每分钟弹幕",value:D.value.avg_danmaku},null,8,["value"])])),_:1}),S(r,{span:8},{default:E((()=>[S(l,{title:"观看人数",value:D.value.watched},null,8,["value"])])),_:1})])),_:1}),A("div",G,[S(P,{ref_key:"cloud",ref:C},null,512)])]),L],64)}}}),[["__scopeId","data-v-280a5f94"]]);export{O as default};
