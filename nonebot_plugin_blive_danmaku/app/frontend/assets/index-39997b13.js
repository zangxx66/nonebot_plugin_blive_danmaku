import{a as e,p as a,w as l,x as t,y as s,g as u,A as o,B as d,C as r,D as n,n as i,F as p,c as m,G as c,H as v,v as f,t as g,u as _,I as y}from"./elementPlus-ce38aef7.js";import{F as h,t as k,aQ as b,p as x,f as V,U as C,Z as U,u as z,g as Y,o as w,a0 as j,a6 as D,_ as T,V as I,am as M,a1 as X,aW as E,aX as P}from"./vendor-0eb16a42.js";import{u as S,g as F,d as W,b as q,e as A,c as B}from"./index-9c474c60.js";import{_ as G}from"./_plugin-vue_export-helper-1b428a4d.js";import"./lodash-520df23f.js";const H=e=>(E("data-v-9fe235af"),e=e(),P(),e),N={class:"danmaku-room-list"},O={class:"image-slot"},Q=["onClick"],Z={style:{padding:"14px"}},J={class:"danmaku-badge"},K={class:"bottom"},L={class:"time"},R=H((()=>Y("br",null,null,-1))),$=H((()=>Y("br",null,null,-1))),ee={style:{"margin-top":"20px","margin-bottom":"20px"}},ae=G(h({__name:"index",setup(h){const E=k([]),P=k(0),G=k(1),H=k([10,20,30,50]),ae=k(20),le=k(!0),te=k(),se=k({}),ue=S(),oe=e=>{ae.value=e,pe()},de=e=>{G.value=e,pe()},re=b(),ne=e=>{re.push({path:"/room",query:{roomid:e,type:ue.getType,type_id:ue.getTypeId,uid:ue.getUid}})},ie=()=>{te.value.setScrollTop(0)},pe=()=>{le.value=!0;const a=ue.getType,l=ue.getTypeId,t=ue.getUid;if(!a||!l)return e({title:"Error",message:"当前地址有误，请从bot重新获取面板地址",type:"error"}),le.value=!1,!1;const s={type:a,type_id:l,uid:t,page:G.value,size:ae.value,title:se.value.title,danmaku:se.value.danmaku,start:se.value.start,end:se.value.end};W(s).then((async a=>{if(0!=a.code)return e({title:"Error",message:a.msg||"系统异常",type:"error"}),!1;const l=a.data,t=l.rows;for(let e of t)e.cover.startsWith("/")&&(e.cover=q+e.cover);E.value=[],Object.assign(E.value,t),P.value=l.total,le.value=!1,ie()})).catch((a=>{le.value=!1,e({title:"Error",message:"请求异常",type:"error"})}))},me=()=>{G.value=1,pe()};return x((()=>{ie();const e=F("type"),a=F("type_id");ue.setState(a,e);const l=F("uid");ue.setUid(l),(()=>{const e={uid:ue.getUid};A(e).then((e=>{document.title=e.data.data}))})(),pe()})),(e,h)=>{const k=o,b=d,x=r,S=n,F=i,W=p,q=a,A=m,ue=l,re=_,ie=y,pe=c,ce=t,ve=v,fe=f;return w(),V("div",N,[C(q,{style:{width:"100%"}},{default:U((()=>[C(W,{ref:"form",model:se.value,inline:"","label-position":"left","label-width":"50px"},{default:U((()=>[C(b,{label:"标题"},{default:U((()=>[C(k,{modelValue:se.value.title,"onUpdate:modelValue":h[0]||(h[0]=e=>se.value.title=e),placeholder:"输入一个直播标题"},null,8,["modelValue"])])),_:1}),C(b,{label:"路灯"},{default:U((()=>[C(k,{modelValue:se.value.danmaku,"onUpdate:modelValue":h[1]||(h[1]=e=>se.value.danmaku=e),placeholder:"这里可以搜索路灯"},null,8,["modelValue"])])),_:1}),C(b,{label:"时间"},{default:U((()=>[C(S,{span:6},{default:U((()=>[C(x,{modelValue:se.value.start,"onUpdate:modelValue":h[2]||(h[2]=e=>se.value.start=e),type:"date",label:"Pick a date","value-format":"X",placeholder:"选择一个开始日期",format:"YYYY-MM-DD"},null,8,["modelValue"])])),_:1}),C(S,{class:"text-center",span:6},{default:U((()=>[j("-")])),_:1}),C(S,{span:6},{default:U((()=>[C(x,{modelValue:se.value.end,"onUpdate:modelValue":h[3]||(h[3]=e=>se.value.end=e),type:"date",label:"Pick a date","value-format":"X",placeholder:"选择一个结束日期",format:"YYYY-MM-DD"},null,8,["modelValue"])])),_:1})])),_:1}),C(b,null,{default:U((()=>[C(F,{type:"primary",onClick:me},{default:U((()=>[j("搜索")])),_:1})])),_:1})])),_:1},8,["model"])])),_:1}),C(ue,null,{default:U((()=>[C(A,null,{default:U((()=>[C(z(s))])),_:1})])),_:1}),C(z(u),{class:"danmaku-scroll-area","max-height":"40rem",ref_key:"scrollbar",ref:te,"view-style":{overflowX:"hidden"}},{default:U((()=>[D((w(),T(ce,{gutter:10,style:{width:"100em"}},{default:U((()=>[E.value.length>0?(w(!0),V(I,{key:0},M(E.value,(e=>(w(),T(S,{key:e.id,span:6,style:{"padding-top":"1%","padding-bottom":"1%"}},{default:U((()=>[C(q,{class:"danmaku-room-card"},{default:U((()=>[C(re,{alt:e.title,src:e.cover,referrerpolicy:"no-referrer",loading:"lazy","scroll-container":".danmaku-scroll-area",style:{cursor:"pointer"},onClick:a=>ne(e.id)},{placeholder:U((()=>[D(Y("div",O,null,512),[[fe,!0]])])),error:U((()=>[Y("div",{class:"image-slot",onClick:a=>ne(e.id)},[C(A,null,{default:U((()=>[C(z(g))])),_:1})],8,Q)])),_:2},1032,["alt","src","onClick"]),Y("div",Z,[C(ie,{value:e.count,max:99},{default:U((()=>[Y("span",J,X(e.title),1)])),_:2},1032,["value"]),Y("div",K,[Y("time",L,[j("开始："+X(z(B)(e.start_time))+" ",1),R,j("~"),$,j(" 结束："+X(z(B)(e.end_time)),1)]),C(F,{text:"",class:"button"},{default:U((()=>[j(X(e.name),1)])),_:2},1024)])])])),_:2},1024)])),_:2},1024)))),128)):(w(),T(S,{key:1,span:24},{default:U((()=>[C(pe,{description:"No data"})])),_:1}))])),_:1})),[[fe,le.value]])])),_:1},512),Y("div",ee,[C(ce,{gutter:20},{default:U((()=>[C(S,{span:12,offset:0},{default:U((()=>[C(ve,{background:"",layout:"total,sizes,prev,pager,next","page-size":ae.value,"page-sizes":H.value,total:P.value,"current-page":G.value,onSizeChange:oe,onCurrentChange:de},null,8,["page-size","page-sizes","total","current-page"])])),_:1})])),_:1})])])}}}),[["__scopeId","data-v-9fe235af"]]);export{ae as default};
