import{l as e,m as a,n as t,v as l,o as s,p as r,q as u,r as o,j as d,s as n,t as i,u as p,w as m,x as v}from"./elementPlus-1c2335c6.js";import{F as c,t as f,p as y,f as g,U as _,Z as h,a6 as b,_ as k,o as V,a0 as w,V as x,an as z,aP as C,g as Y,a1 as j,u as U}from"./vendor-3efffbad.js";import{g as D,r as M,b as P,C as E}from"./api-a97bd869.js";import{u as q}from"./index-f5e6f37d.js";import"./lodash-520df23f.js";const G={class:"danmaku-room-list"},S={style:{padding:"14px"}},T={class:"bottom"},X={class:"time"},$=Y("br",null,null,-1),F=Y("br",null,null,-1),I=c({__name:"index",setup(c){const I=f([]),L=f(0),N=f(1),R=f([10,20,30,50]),Z=f(20),A=f(!0),B=f({}),H=q();document.title="主页-blive_danmaku";const J=e=>{Z.value=e,O()},K=e=>{N.value=e,O()},O=()=>{A.value=!0;const a=H.getType,t=H.getTypeId;if(!a||!t)return e({title:"Error",message:"当前地址有误，请从bot重新获取面板地址",type:"error"}),A.value=!1,!1;const l={type:a,type_id:t,page:N.value,size:Z.value,title:B.value.title,danmaku:B.value.danmaku,start:B.value.start,end:B.value.end};M.GetRoomList(l).then((async a=>{if(0!=a.code)return e({title:"Error",message:a.msg||"系统异常",type:"error"}),!1;const t=a.data,l=t.rows;for(let e of l)if(e.cover.includes("i0.hdslb.com")){const a=await M.GetCoverUrl({url:e.cover,rid:e.id});0===a.code&&(e.cover=`${P}${a.data.data}`)}I.value=[],I.value=l,L.value=t.total,A.value=!1})).catch((a=>{A.value=!1,e({title:"Error",message:"请求异常",type:"error"})}))},Q=C(),W=()=>{N.value=1,O()};return y((()=>{const e=D("type"),a=D("type_id");H.setState(a,e),O()})),(e,c)=>{const f=s,y=r,C=u,D=o,M=d,P=n,q=a,H=m,O=v,ee=i,ae=t,te=p,le=l;return V(),g("div",G,[_(q,{style:{width:"60rem"}},{default:h((()=>[_(P,{ref:"form",model:B.value,"label-position":"left",size:"default"},{default:h((()=>[_(y,{label:"标题"},{default:h((()=>[_(f,{"input-style":"width:40%",modelValue:B.value.title,"onUpdate:modelValue":c[0]||(c[0]=e=>B.value.title=e),placeholder:"输入一个直播标题或主播名称"},null,8,["modelValue"])])),_:1}),_(y,{label:"路灯"},{default:h((()=>[_(f,{"input-style":"width:40%",modelValue:B.value.danmaku,"onUpdate:modelValue":c[1]||(c[1]=e=>B.value.danmaku=e),placeholder:"这里可以搜索路灯"},null,8,["modelValue"])])),_:1}),_(y,{label:"时间"},{default:h((()=>[_(D,{span:6},{default:h((()=>[_(C,{modelValue:B.value.start,"onUpdate:modelValue":c[2]||(c[2]=e=>B.value.start=e),type:"date",label:"Pick a date","value-format":"X",placeholder:"选择一个开始日期",format:"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),_(D,{class:"text-center",span:1,style:{margin:"0 0.5rem"}},{default:h((()=>[w("-")])),_:1}),_(D,{span:6},{default:h((()=>[_(C,{modelValue:B.value.end,"onUpdate:modelValue":c[3]||(c[3]=e=>B.value.end=e),type:"date",label:"Pick a date","value-format":"X",placeholder:"选择一个结束日期",format:"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),_(y,null,{default:h((()=>[_(M,{type:"primary",onClick:W},{default:h((()=>[w("搜索")])),_:1})])),_:1})])),_:1},8,["model"])])),_:1}),b((V(),k(ae,{gutter:10,style:{width:"100rem"}},{default:h((()=>[I.value.length>0?(V(!0),g(x,{key:0},z(I.value,(e=>(V(),k(D,{key:e.id,span:6,style:{"padding-top":"1%"}},{default:h((()=>[_(q,null,{default:h((()=>[_(O,{placement:"top",width:400,title:e.name,trigger:"hover",content:e.title},{reference:h((()=>[_(H,{alt:e.title,src:e.cover,"referrer-policy":"no-referrer",style:{cursor:"pointer"},onClick:a=>{return t=e.id,void Q.push({path:"/room",query:{roomid:t}});var t}},null,8,["alt","src","onClick"])])),_:2},1032,["title","content"]),Y("div",S,[Y("span",null,j(e.title),1),Y("div",T,[Y("time",X,[w("开始："+j(U(E)(e.start_time))+" ",1),$,w("~"),F,w(" 结束："+j(U(E)(e.end_time)),1)]),_(M,{text:"",class:"button"},{default:h((()=>[w(j(e.name),1)])),_:2},1024)])])])),_:2},1024)])),_:2},1024)))),128)):(V(),k(D,{key:1,span:24},{default:h((()=>[_(ee,{description:"No data"})])),_:1}))])),_:1})),[[le,A.value]]),_(ae,{gutter:20,style:{"margin-top":"20px","margin-bottom":"20px"}},{default:h((()=>[_(D,{span:12,offset:10},{default:h((()=>[_(te,{background:"",layout:"total,sizes,prev,pager,next","page-size":Z.value,"page-sizes":R.value,total:L.value,"current-page":N.value,onSizeChange:J,onCurrentChange:K},null,8,["page-size","page-sizes","total","current-page"])])),_:1})])),_:1})])}}});export{I as default};
