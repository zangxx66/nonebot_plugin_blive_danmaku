import{l as e,m as t,n as a,v as l,o as s,p as r,q as o,r as u,s as d,j as n,t as i,u as p,w as m,x as c,y as f}from"./elementPlus-1c1092e2.js";import{F as v,t as y,p as g,f as _,U as h,Z as b,a6 as k,_ as x,o as V,a0 as w,V as Y,an as j,aP as U,g as C,a1 as P,u as D}from"./vendor-3efffbad.js";import{g as M,r as z,b as E,C as q}from"./api-a97bd869.js";import{u as G}from"./index-beb6cf70.js";import"./lodash-520df23f.js";const T={class:"danmaku-room-list"},X={style:{padding:"14px"}},$={class:"bottom"},F={class:"time"},I=v({__name:"index",setup(v){const I=y([]),L=y(0),N=y(1),R=y(!0),S=y({}),Z=G();document.title="主页-blive_danmaku";const A=()=>{},B=()=>{R.value=!0;const t=Z.getType,a=Z.getTypeId;if(!t||!a)return e({title:"Error",message:"当前地址有误，请从bot重新获取面板地址",type:"error"}),R.value=!1,!1;const l={type:t,type_id:a,page:N.value,size:30,title:S.value.title,start:S.value.start,end:S.value.end};z.GetRoomList(l).then((async t=>{if(0!=t.code)return e({title:"Error",message:t.msg||"系统异常",type:"error"}),!1;const a=t.data,l=a.rows;for(let e of l)if(e.cover.includes("i0.hdslb.com")){const t=await z.GetCoverUrl({url:e.cover,rid:e.id});0===t.code&&(e.cover=`${E}${t.data.data}`)}I.value=l,L.value=a.total,R.value=!1})).catch((t=>{R.value=!1,e({title:"Error",message:"请求异常",type:"error"})}))},H=U(),J=()=>{N.value=1,B()};return g((()=>{const e=M("type"),t=M("type_id");Z.setState(t,e),B()})),(e,v)=>{const y=r,g=o,U=u,M=d,z=n,E=i,G=t,Z=c,K=f,O=p,Q=a,W=m,ee=l,te=s;return V(),_("div",T,[h(G,{style:{width:"60rem"}},{default:b((()=>[h(E,{ref:"form",inline:!0,model:S.value,"label-position":"left",size:"default"},{default:b((()=>[h(g,{label:"标题"},{default:b((()=>[h(y,{modelValue:S.value.title,"onUpdate:modelValue":v[0]||(v[0]=e=>S.value.title=e)},null,8,["modelValue"])])),_:1}),h(g,{label:"时间"},{default:b((()=>[h(M,{span:11},{default:b((()=>[h(U,{modelValue:S.value.start,"onUpdate:modelValue":v[1]||(v[1]=e=>S.value.start=e),type:"date",label:"Pick a date","value-format":"X",placeholder:"选择一个开始日期",format:"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),h(M,{class:"text-center",span:1,style:{margin:"0 0.5rem"}},{default:b((()=>[w("-")])),_:1}),h(M,{span:11},{default:b((()=>[h(U,{modelValue:S.value.end,"onUpdate:modelValue":v[2]||(v[2]=e=>S.value.end=e),type:"date",label:"Pick a date","value-format":"X",placeholder:"选择一个结束日期",format:"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),h(g,null,{default:b((()=>[h(z,{type:"primary",onClick:J},{default:b((()=>[w("搜索")])),_:1})])),_:1})])),_:1},8,["model"])])),_:1}),k((V(),x(Q,{gutter:10,"infinite-scroll-disabled":true,style:{width:"100rem"}},{default:b((()=>[I.value.length>0?(V(!0),_(Y,{key:0},j(I.value,(e=>(V(),x(M,{key:e.id,span:8,style:{"padding-top":"1%"}},{default:b((()=>[h(G,null,{default:b((()=>[h(K,{placement:"top",width:400,title:e.name,trigger:"hover",content:e.title},{reference:b((()=>[h(Z,{alt:e.title,src:e.cover,"referrer-policy":"no-referrer",style:{cursor:"pointer"},onClick:t=>{return a=e.id,void H.push({path:"/room",query:{roomid:a}});var a}},null,8,["alt","src","onClick"])])),_:2},1032,["title","content"]),C("div",X,[C("span",null,P(e.title),1),C("div",$,[C("time",F,P(D(q)(e.start_time))+" ~ "+P(D(q)(e.end_time)),1),h(z,{text:"",class:"button"},{default:b((()=>[w(P(e.name),1)])),_:2},1024)])])])),_:2},1024)])),_:2},1024)))),128)):(V(),x(M,{key:1,span:24},{default:b((()=>[h(O,{description:"No data"})])),_:1}))])),_:1})),[[ee,R.value],[te,A]]),h(Q,{gutter:20,style:{"margin-top":"20px","margin-bottom":"20px"}},{default:b((()=>[h(M,{span:12,offset:10},{default:b((()=>[h(W,{background:"",layout:"prev,pager,next","page-size":30,total:L.value,"current-page":N.value,"onUpdate:currentPage":B},null,8,["total","current-page"])])),_:1})])),_:1})])}}});export{I as default};
