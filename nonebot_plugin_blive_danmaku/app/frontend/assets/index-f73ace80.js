import{a as V,p as K,w as O,x as J,y as Z,k as ee,A as te,B as ae,C as le,D as oe,c as se,F as ne,e as re,G as de,H as ue,v as ce,t as ie,u as _e,I as pe}from"./elementPlus-6d4b871f.js";import{E as me,r as c,aK as fe,b as ve,j as P,P as e,S as t,u as g,k as d,h as y,V as p,a0 as N,T as x,Q as ge,ad as ye,W as E}from"./vendor-9f742c23.js";import{u as he,g as w,e as ke,b as be,f as Ee,c as F}from"./index-13d8bbb1.js";import"./lodash-742d3967.js";const Ce={class:"danmaku-room-list"},Ve={class:"image-slot"},xe=["onClick"],we={style:{padding:"14px"}},Te={class:"danmaku-badge"},ze={class:"bottom"},De={class:"time"},Se=d("br",null,null,-1),Ue=d("br",null,null,-1),Ye={style:{"margin-top":"20px","margin-bottom":"20px"}},Le=me({__name:"index",setup(Be){const h=c([]),T=c(0),k=c(1),L=c([10,20,30,50]),C=c(20),m=c(!0),z=c(),o=c({}),n=he(),M=s=>{C.value=s,b()},G=s=>{k.value=s,b()},R=fe(),D=s=>{R.push({path:"/room",query:{roomid:s,type:n.getType,type_id:n.getTypeId,uid:n.getUid}})},S=()=>{z.value.setScrollTop(0)},b=()=>{m.value=!0;const s=n.getType,l=n.getTypeId,i=n.getUid;if(!s||!l)return V({title:"Error",message:"当前地址有误，请从bot重新获取面板地址",type:"error"}),m.value=!1,!1;const _={type:s,type_id:l,uid:i,page:k.value,size:C.value,title:o.value.title,danmaku:o.value.danmaku,start:o.value.start,end:o.value.end};ke(_).then(u=>{if(u.code!=0)return V({title:"Error",message:u.msg||"系统异常",type:"error"}),!1;const r=u.data,f=r.rows;for(let v of f)v.cover.startsWith("/")&&(v.cover=be+v.cover);h.value=[],Object.assign(h.value,f),T.value=r.total,m.value=!1,S()}).catch(u=>{m.value=!1,console.error(u),V({title:"Error",message:"请求异常",type:"error"})})},X=()=>{k.value=1,b()},j=()=>{const s={uid:n.getUid};Ee(s).then(l=>{document.title=l.data.data})};return ve(()=>{S();const s=w("type"),l=w("type_id");n.setState(l,s);const i=w("uid");n.setUid(i),j(),b()}),(s,l)=>{const i=te,_=ae,u=le,r=oe,f=se,v=ne,U=K,Y=re,Q=O,W=_e,$=pe,q=de,B=J,A=ue,I=ce;return y(),P("div",Ce,[e(U,{style:{width:"100%"}},{default:t(()=>[e(v,{ref:"form",model:o.value,inline:"","label-position":"left","label-width":"50px"},{default:t(()=>[e(_,{label:"标题"},{default:t(()=>[e(i,{modelValue:o.value.title,"onUpdate:modelValue":l[0]||(l[0]=a=>o.value.title=a),clearable:"",placeholder:"输入一个直播标题"},null,8,["modelValue"])]),_:1}),e(_,{label:"路灯"},{default:t(()=>[e(i,{modelValue:o.value.danmaku,"onUpdate:modelValue":l[1]||(l[1]=a=>o.value.danmaku=a),clearable:"",placeholder:"这里可以搜索路灯"},null,8,["modelValue"])]),_:1}),e(_,{label:"时间"},{default:t(()=>[e(r,{span:6},{default:t(()=>[e(u,{modelValue:o.value.start,"onUpdate:modelValue":l[2]||(l[2]=a=>o.value.start=a),type:"date",label:"Pick a date","value-format":"X",placeholder:"选择一个开始日期",format:"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),e(r,{class:"text-center",span:6},{default:t(()=>[p("-")]),_:1}),e(r,{span:6},{default:t(()=>[e(u,{modelValue:o.value.end,"onUpdate:modelValue":l[3]||(l[3]=a=>o.value.end=a),type:"date",label:"Pick a date","value-format":"X",placeholder:"选择一个结束日期",format:"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(f,{type:"primary",onClick:X},{default:t(()=>[p("搜索")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(Q,null,{default:t(()=>[e(Y,null,{default:t(()=>[e(g(Z))]),_:1})]),_:1}),e(g(ee),{class:"danmaku-scroll-area","max-height":"40rem",ref_key:"scrollbar",ref:z,"view-style":{overflowX:"hidden"}},{default:t(()=>[N((y(),x(B,{gutter:10,style:{width:"100em"}},{default:t(()=>[h.value.length>0?(y(!0),P(ge,{key:0},ye(h.value,a=>(y(),x(r,{key:a.id,span:6,style:{"padding-top":"1%","padding-bottom":"1%"}},{default:t(()=>[e(U,{class:"danmaku-room-card"},{default:t(()=>[e(W,{alt:a.title,src:a.cover,referrerpolicy:"no-referrer",loading:"lazy","scroll-container":".danmaku-scroll-area",style:{cursor:"pointer"},onClick:H=>D(a.id)},{placeholder:t(()=>[N(d("div",Ve,null,512),[[I,!0]])]),error:t(()=>[d("div",{class:"image-slot",onClick:H=>D(a.id)},[e(Y,null,{default:t(()=>[e(g(ie))]),_:1})],8,xe)]),_:2},1032,["alt","src","onClick"]),d("div",we,[e($,{value:a.count,max:99},{default:t(()=>[d("span",Te,E(a.title),1)]),_:2},1032,["value"]),d("div",ze,[d("time",De,[p("开始："+E(g(F)(a.start_time))+" ",1),Se,p("~"),Ue,p(" 结束："+E(g(F)(a.end_time)),1)]),e(f,{text:"",class:"button"},{default:t(()=>[p(E(a.name),1)]),_:2},1024)])])]),_:2},1024)]),_:2},1024))),128)):(y(),x(r,{key:1,span:24},{default:t(()=>[e(q,{description:"No data"})]),_:1}))]),_:1})),[[I,m.value]])]),_:1},512),d("div",Ye,[e(B,{gutter:20},{default:t(()=>[e(r,{span:12,offset:0},{default:t(()=>[e(A,{background:"",layout:"total,sizes,prev,pager,next","page-size":C.value,"page-sizes":L.value,total:T.value,"current-page":k.value,onSizeChange:M,onCurrentChange:G},null,8,["page-size","page-sizes","total","current-page"])]),_:1})]),_:1})])])}}});export{Le as default};
