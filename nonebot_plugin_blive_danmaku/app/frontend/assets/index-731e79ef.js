import{l as e,m as a,n as t,v as l,o as s,p as r,q as u,r as o,j as n,s as d,t as i,u as p,w as m,x as c}from"./elementPlus-e0f35a2c.js";import{F as v,t as f,aO as y,p as g,f as _,U as h,Z as b,a6 as k,_ as V,o as w,a0 as x,V as z,an as Y,g as j,a1 as C,u as U}from"./vendor-0407690f.js";import{g as D,G as M,a as E,b as P,C as q}from"./api-7df74b40.js";import{u as O}from"./index-d3b4db6c.js";import"./lodash-520df23f.js";const S={class:"danmaku-room-list"},T={style:{padding:"14px"}},X={class:"bottom"},$={class:"time"},F=j("br",null,null,-1),G=j("br",null,null,-1),I=v({__name:"index",setup(v){const I=f([]),N=f(0),Z=f(1),A=f([10,20,30,50]),B=f(20),H=f(!0),J=f({}),K=O();document.title="主页";const L=e=>{B.value=e,R()},Q=e=>{Z.value=e,R()},R=()=>{H.value=!0;const a=K.getType,t=K.getTypeId;if(!a||!t)return e({title:"Error",message:"当前地址有误，请从bot重新获取面板地址",type:"error"}),H.value=!1,!1;const l={type:a,type_id:t,page:Z.value,size:B.value,title:J.value.title,danmaku:J.value.danmaku,start:J.value.start,end:J.value.end};M(l).then((async a=>{if(0!=a.code)return e({title:"Error",message:a.msg||"系统异常",type:"error"}),!1;const t=a.data,l=t.rows;for(let e of l)if(e.cover.includes("i0.hdslb.com")){const a=await E({url:e.cover,rid:e.id});0===a.code&&(e.cover=`${P}${a.data.data}`)}I.value=[],Object.assign(I.value,l),N.value=t.total,H.value=!1})).catch((a=>{H.value=!1,e({title:"Error",message:"请求异常",type:"error"})}))},W=y(),ee=()=>{Z.value=1,R()};return g((()=>{const e=D("type"),a=D("type_id");K.setState(a,e),R()})),(e,v)=>{const f=s,y=r,g=u,D=o,M=n,E=d,P=a,O=m,K=c,R=i,ae=t,te=p,le=l;return w(),_("div",S,[h(P,{style:{width:"60rem"}},{default:b((()=>[h(E,{ref:"form",model:J.value,"label-position":"left",size:"default"},{default:b((()=>[h(y,{label:"标题"},{default:b((()=>[h(f,{"input-style":"width:40%",modelValue:J.value.title,"onUpdate:modelValue":v[0]||(v[0]=e=>J.value.title=e),placeholder:"输入一个直播标题或主播名称"},null,8,["modelValue"])])),_:1}),h(y,{label:"路灯"},{default:b((()=>[h(f,{"input-style":"width:40%",modelValue:J.value.danmaku,"onUpdate:modelValue":v[1]||(v[1]=e=>J.value.danmaku=e),placeholder:"这里可以搜索路灯"},null,8,["modelValue"])])),_:1}),h(y,{label:"时间"},{default:b((()=>[h(D,{span:6},{default:b((()=>[h(g,{modelValue:J.value.start,"onUpdate:modelValue":v[2]||(v[2]=e=>J.value.start=e),type:"date",label:"Pick a date","value-format":"X",placeholder:"选择一个开始日期",format:"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),h(D,{class:"text-center",span:1,style:{margin:"0 0.5rem"}},{default:b((()=>[x("-")])),_:1}),h(D,{span:6},{default:b((()=>[h(g,{modelValue:J.value.end,"onUpdate:modelValue":v[3]||(v[3]=e=>J.value.end=e),type:"date",label:"Pick a date","value-format":"X",placeholder:"选择一个结束日期",format:"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),h(y,null,{default:b((()=>[h(M,{type:"primary",onClick:ee},{default:b((()=>[x("搜索")])),_:1})])),_:1})])),_:1},8,["model"])])),_:1}),k((w(),V(ae,{gutter:10,style:{width:"100rem"}},{default:b((()=>[I.value.length>0?(w(!0),_(z,{key:0},Y(I.value,(e=>(w(),V(D,{key:e.id,span:6,style:{"padding-top":"1%"}},{default:b((()=>[h(P,null,{default:b((()=>[h(K,{placement:"top",width:400,title:e.name,trigger:"hover",content:e.title},{reference:b((()=>[h(O,{alt:e.title,src:e.cover,"referrer-policy":"no-referrer",style:{cursor:"pointer"},onClick:a=>{return t=e.id,void W.push({path:"/room",query:{roomid:t}});var t}},null,8,["alt","src","onClick"])])),_:2},1032,["title","content"]),j("div",T,[j("span",null,C(e.title),1),j("div",X,[j("time",$,[x("开始："+C(U(q)(e.start_time))+" ",1),F,x("~"),G,x(" 结束："+C(U(q)(e.end_time)),1)]),h(M,{text:"",class:"button"},{default:b((()=>[x(C(e.name),1)])),_:2},1024)])])])),_:2},1024)])),_:2},1024)))),128)):(w(),V(D,{key:1,span:24},{default:b((()=>[h(R,{description:"No data"})])),_:1}))])),_:1})),[[le,H.value]]),h(ae,{gutter:20,style:{"margin-top":"20px","margin-bottom":"20px"}},{default:b((()=>[h(D,{span:12,offset:10},{default:b((()=>[h(te,{background:"",layout:"total,sizes,prev,pager,next","page-size":B.value,"page-sizes":A.value,total:N.value,"current-page":Z.value,onSizeChange:L,onCurrentChange:Q},null,8,["page-size","page-sizes","total","current-page"])])),_:1})])),_:1})])}}});export{I as default};
