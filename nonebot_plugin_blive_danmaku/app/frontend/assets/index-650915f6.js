import{a,U as e,D as t,x as s}from"./elementPlus-3d0525cb.js";import{g as o,h as l,R as r,F as n}from"./index-293a538b.js";import{E as u,aP as d,aQ as i,r as m,h as c,T as p,u as g,aR as h,b as v,j as f,k as _,P as y,S as k,Q as b,aM as x,aN as w}from"./vendor-91b05db9.js";import{L as j,u as A,i as S,a as F,b as D,c as E,d as L,e as P,f as R,g as T,h as z,j as C,k as G}from"./echarts-3e486507.js";import{_ as I}from"./_plugin-vue_export-helper-1b428a4d.js";import"./lodash-520df23f.js";const Q=u({__name:"wordcloud",setup(a,{expose:e}){d(i);const t=m({credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!1},title:{text:"弹幕热词"},chart:{spacingLeft:5,spacingRight:5,backgroundColor:"rgba(255, 255, 255,0)"},series:[{type:"wordcloud",name:"出现次数",spiral:"rectangular",data:Array(),rotation:90,maxFontSize:40,minFontSize:14,style:{fontFamily:"sans-serif",fontWeight:"500"}}]});return e({loadData(a){const e=Array();for(let t of a)e.push({name:t.message,weight:t.sum});t.value.series[0].data=e}}),(a,e)=>(c(),p(g(h.Chart),{style:{width:"65rem",height:"100px"},options:t.value},null,8,["options"]))}}),W={class:"danmaku-hot-word"},B=(a=>(x("data-v-280a5f94"),a=a(),w(),a))((()=>_("div",{id:"danmaku-chart",class:"danmaku-chart"},null,-1))),M=I(u({__name:"index",setup(u){const d=m(),i=m({total:0,avg_danmaku:0,watched:0,hot_word:Array(),minute_danmaku:Array()}),p=()=>{const e=o("roomid");l({rid:e}).then((e=>{if(0!=e.code)a({title:"提示",message:"获取统计信息失败",type:"error"});else{i.value.avg_danmaku=e.data.avg_danmaku,i.value.total=e.data.total;const a=e.data.hot_word;d.value.loadData(a),a.forEach((a=>a.message=r(a.message))),i.value.hot_word=a,i.value.minute_danmaku=e.data.min_danmaku,i.value.watched=e.data.watched,(()=>{const a={xAxis:{type:"category",data:Array.from(i.value.minute_danmaku,(({countTime:a})=>n(a))),boundaryGap:!1,axisTick:{alignWithLabel:!0}},yAxis:{type:"value",boundaryGap:[0,"100%"],name:"弹幕数"},series:[{name:"弹幕数",data:Array.from(i.value.minute_danmaku,(({sum:a})=>a)),type:"line",symbol:"rect",sampling:"lttb",smooth:!0,itemStyle:{color:"rgb(255, 70, 131)"},areaStyle:{color:new j(0,0,0,1,[{offset:0,color:"rgb(255, 158, 68)"},{offset:1,color:"rgb(255, 70, 131)"}])}}],tooltip:{trigger:"axis",position:a=>[a[0],"10%"]},title:{text:"每分钟弹幕统计"},dataZoom:[{type:"inside",start:0,end:100},{start:0,end:100}]};A([F,D,E,L,P,R,T,z,C,G]);const e=document.getElementById("danmaku-chart");S(e).setOption(a)})()}})).catch((e=>{a({title:"提示",message:e||"获取统计信息失败",type:"error"})}))};return v((()=>{p()})),(a,o)=>{const l=e,r=t,n=s;return c(),f(b,null,[_("div",null,[y(n,null,{default:k((()=>[y(r,{span:8},{default:k((()=>[y(l,{title:"弹幕数",value:i.value.total},null,8,["value"])])),_:1}),y(r,{span:8},{default:k((()=>[y(l,{title:"平均每分钟弹幕",value:i.value.avg_danmaku},null,8,["value"])])),_:1}),y(r,{span:8},{default:k((()=>[y(l,{title:"观看人数",value:i.value.watched},null,8,["value"])])),_:1})])),_:1}),_("div",W,[y(Q,{ref_key:"cloud",ref:d},null,512)])]),B],64)}}}),[["__scopeId","data-v-280a5f94"]]);export{M as default};
