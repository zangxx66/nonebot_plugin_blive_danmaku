import{n as e,w as a,L as l,B as s,M as t,N as u,A as n,O as o,P as r,Q as d,F as m,o as i,R as v,S as c,a as p,x as f,T as _,G as g,D as h}from"./elementPlus-2bbb65c2.js";import{_ as y,g as N,f as b,F as w,R as V}from"./index-3b039937.js";import{aF as M,aO as k,E as C,aH as L,r as R,h as x,T as F,S,P as T,u as U,k as j,V as E,s as H,b as O,ax as P,j as A,Q as D,ad as I,W as z,a0 as B,aM as Q,aN as G}from"./vendor-fa374c7f.js";import{_ as W}from"./_plugin-vue_export-helper-1b428a4d.js";import"./lodash-520df23f.js";M.locale("zh-cn");const $=async(e,a)=>{const l=await k(document.getElementById(e),{scale:a,backgroundColor:null,useCORS:!0}),s=document.createElement("a");s.download=`sc-image-${M().unix()}.png`,s.href=l.toDataURL("image/png"),s.click(),s.remove()},q={style:{"text-align":"left","padding-top":"1rem"}},J=C({__name:"sc",setup(v,{expose:c}){const p=L({loader:()=>y((()=>import("./SuperChat-fcb4d4cd.js")),["assets/SuperChat-fcb4d4cd.js","assets/vendor-fa374c7f.js","assets/vendor-b57f6aba.css","assets/_plugin-vue_export-helper-1b428a4d.js","assets/elementPlus-2bbb65c2.js","assets/lodash-520df23f.js","assets/elementPlus-5cfbb218.css","assets/index-3b039937.js","assets/index-4d7b4401.css","assets/SuperChat-8f8a299b.css"])}),f=R({width:269,battery:300,userName:"",userRole:"0",scContent:"",showTrans:!1,transContent:"",showFansMedal:!1,medalName:"",medalLevel:1,guardMileStone:"0"}),_=(e,a)=>{if(!e||null==e)return"";let l=0,s="";for(let t=0;t<e.length&&(l+=e.charCodeAt(t)>255?2:1,!(l>a));t++)s=e.substring(0,t+1);return s},g=R(!1),h=R({isFansName:f.value.showFansMedal,fansName:_(f.value.medalName,6),fansLevel:f.value.medalLevel,guardMil:f.value.guardMileStone,userRole:f.value.userRole}),N=()=>{g.value=!1,h.value.isFansName=!1,h.value.fansName="",h.value.guardMil="0",h.value.fansLevel=1};return c({open(e){f.value=e,f.value.medalName=_(f.value.medalName,6),h.value.isFansName=f.value.showFansMedal,h.value.userRole=f.value.userRole,g.value=!0}}),(v,c)=>{const y=e,b=a,w=l,V=s,M=t,k=u,C=n,L=o,R=r,H=d,O=m,P=i;return x(),F(P,{modelValue:g.value,"onUpdate:modelValue":c[6]||(c[6]=e=>g.value=e),modal:!1,"before-close":N,title:"生成SC图片",width:"60%"},{default:S((()=>[T(U(p),{width:f.value.width,battery:f.value.battery,userName:f.value.userName,userRole:h.value.userRole,scContent:f.value.scContent,showTrans:f.value.showTrans,transContent:f.value.transContent,showFansMedal:h.value.isFansName,medalName:_(h.value.fansName,6),medalLevel:h.value.fansLevel,guardMileStone:h.value.guardMil},null,8,["width","battery","userName","userRole","scContent","showTrans","transContent","showFansMedal","medalName","medalLevel","guardMileStone"]),j("div",q,[T(y,{type:"primary",onClick:c[0]||(c[0]=e=>U($)("SuperChat",1))},{default:S((()=>[E("导出图片")])),_:1})]),T(b,{"content-position":"left"},{default:S((()=>[E("设置")])),_:1}),T(O,{model:h.value},{default:S((()=>[T(V,{label:"显示粉丝牌"},{default:S((()=>[T(w,{modelValue:h.value.isFansName,"onUpdate:modelValue":c[1]||(c[1]=e=>h.value.isFansName=e)},null,8,["modelValue"])])),_:1}),T(V,{label:"用户身份"},{default:S((()=>[T(k,{modelValue:h.value.userRole,"onUpdate:modelValue":c[2]||(c[2]=e=>h.value.userRole=e)},{default:S((()=>[T(M,{label:"普通",value:"0"}),T(M,{label:"舰长",value:"3"}),T(M,{label:"提督",value:"2"}),T(M,{label:"总督",value:"1"})])),_:1},8,["modelValue"])])),_:1}),T(V,{label:"粉丝牌名称"},{default:S((()=>[T(C,{modelValue:h.value.fansName,"onUpdate:modelValue":c[3]||(c[3]=e=>h.value.fansName=e)},null,8,["modelValue"])])),_:1}),T(V,{label:"粉丝牌等级"},{default:S((()=>[T(L,{modelValue:h.value.fansLevel,"onUpdate:modelValue":c[4]||(c[4]=e=>h.value.fansLevel=e),min:"1"},null,8,["modelValue"])])),_:1}),T(V,{label:"舰队里程碑"},{default:S((()=>[T(H,{modelValue:h.value.guardMil,"onUpdate:modelValue":c[5]||(c[5]=e=>h.value.guardMil=e)},{default:S((()=>[T(R,{label:"0"},{default:S((()=>[E("其他")])),_:1}),T(R,{label:"k"},{default:S((()=>[E("千舰")])),_:1}),T(R,{label:"w"},{default:S((()=>[E("万舰")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])}}}),K={class:"demo-input-suffix"},X=(e=>(Q("data-v-0ec0a539"),e=e(),G(),e))((()=>j("span",{class:"ml-3 text-gray-600 inline-flex items-center"},"路灯：",-1))),Y={key:0,class:"ml-2"},Z=["innerHTML"],ee={key:1,class:"ml-2"},ae=["innerHTML"],le=W(C({__name:"index",setup(a){const l=R(),s=R([]),t=R({danmaku:""}),u=H((()=>{const e=t.value.danmaku;if(!e)return s.value;return s.value.filter((a=>a.message.includes(e)||a.uname.includes(e)))})),o=()=>{p({title:"提示",message:"已复制时间点到剪切板",type:"success"})},r=()=>{p({title:"Error",message:"复制失败",type:"error"})},d=e=>({msg:e,success:o,error:r});return O((()=>{(()=>{const e=N("roomid");b({rid:e}).then((e=>{if(0!=e.code)p({title:"Error",message:e.msg||"获取弹幕异常",type:"error"});else{const a=e.data.rows;for(let e of a)e.hour_minute=w(e.create_time),e.message=V(e.message),e.type&&"street_lamp"!=e.type||(e.message=e.message.replace("#路灯","").trim());s.value=a}}))})()})),(a,o)=>{const r=n,m=f,i=e,p=_,y=g,N=h,b=P("clipboard");return x(),A(D,null,[j("div",K,[T(m,{gutter:20},{default:S((()=>[X,T(r,{class:"w-50",style:{width:"12.5rem"},modelValue:t.value.danmaku,"onUpdate:modelValue":o[0]||(o[0]=e=>t.value.danmaku=e),placeholder:"请在此输入搜索内容","prefix-icon":U(v)},null,8,["modelValue","prefix-icon"])])),_:1})]),T(m,{gutter:20},{default:S((()=>[T(N,{span:24},{default:S((()=>[s.value.length>0?(x(!0),A(D,{key:0},I(u.value,(e=>(x(),A("ul",{key:e.id,style:{"text-align":"left"}},["street_lamp"!=e.type&&e.type?(x(),A("span",ee,[E(z(e.uname)+"  "+z(e.hour_minute)+"(",1),B((x(),F(i,{type:"info",link:""},{default:S((()=>[E(z(e.live_duration),1)])),_:2},1024)),[[b,d(e.live_duration)]]),E(") : "),j("span",{class:"danmaku-message",innerHTML:e.message},null,8,ae),T(p,{effect:"dark",placement:"top",content:"点击生成SC图片"},{default:S((()=>[T(i,{onClick:a=>(e=>{const a={width:269,battery:Number(10*e.price),userName:e.uname,userRole:e.guard.toString(),scContent:e.message,showTrans:!1,transContent:"",showFansMedal:!1,medalName:"",medalLevel:1,guardMileStone:"0"};l.value.open(a)})(e),icon:U(c),size:"small",type:"primary",circle:""},null,8,["onClick","icon"])])),_:2},1024)])):(x(),A("span",Y,[E(z(e.uname)+"  "+z(e.hour_minute)+" (",1),B((x(),F(i,{type:"info",link:""},{default:S((()=>[E(z(e.live_duration),1)])),_:2},1024)),[[b,d(e.live_duration)]]),E(") : "),j("span",{innerHTML:e.message},null,8,Z)]))])))),128)):(x(),F(y,{key:1,description:"No data"}))])),_:1})])),_:1}),T(J,{ref_key:"hd",ref:l},null,512)],64)}}}),[["__scopeId","data-v-0ec0a539"]]);export{le as default};
